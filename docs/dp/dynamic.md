在学习本章前请确认你已经学习了 [矩阵](../math/matrix.md) [树链剖分](../graph/hld.md)

动态DP问题是猫锟在WC2018讲得黑科技，一般用来解决树上的DP问题，同时支持点权(边权)修改操作。

因为NOIP2018D2T3考了所以突然风靡Oier圈。

## 例子

以这道模板题为例子讲解一下动态DP的过程。

??? note " 例题[洛谷 P4719 【模板】动态 DP](https://www.luogu.org/problem/P4719) "
    给定一棵 $n$ 个点的树，点带点权。有 $m$ 次操作，每次操作给定 $x,y$ 表示修改点 $x$ 的权值为 $y$ 。你需要在每次操作之后求出这棵树的最大权独立集的权值大小。

#### 广义矩阵乘法

定义广义矩阵乘法 $A\times B=C$ 为

$$
C_{i,j}=max_{k=1}^{n}(A_{i,k}+B_{k,j})
$$
相当于将普通的矩阵乘法中的乘变为加，加变为 $max$ 操作

同时广义矩阵乘法满足结合律，所以可以使用矩阵快速幂

#### 不带修改操作

令 $f[i][0]$ 表示不选择 $i$ 的最大答案，$f[i][1]$ 表示选择 $i$ 的最大答案

则有DP方程 $\begin{cases}f[i][0]=\sum_{son}max(f[son][0],f[son][1])\\f[i][1]=\sum_{son}f[son][0]\end{cases}$

答案就是 $max(f[root][0],f[root][1])$ 

#### 带修改操作

首先将这棵树进行树链剖分，假设有这样一条重链